---
title: Understanding CPU
category: tech
tags: [cpu, programming, memory, architecture]
---

title:  Understanding CPU

* TOC
{:toc}


# CPU overview


# L3 cache

## L3 cache size of AMD EPYC CPUs on the performance

### overview

[Evaluating the impact of the L3 cache size of AMD EPYC CPUs on the performance of CFD applications](https://arxiv.org/html/2505.17934v1)

- provides typical AMD processor L1/L2/L3 info

[AMD EPYC™ 9004 Series Architecture Overview](https://www.amd.com/content/dam/amd/en/documents/epyc-technical-docs/tuning-guides/58015-epyc-9004-tg-architecture-overview.pdf)

[4TH GEN AMD EPYC™ PROCESSOR ARCHITECTURE](https://www.amd.com/content/dam/amd/en/documents/products/epyc/4th-gen-epyc-processor-architecture-white-paper.pdf)


## Can single L3 group cross more than one numa node?

Answer: No, an L3 cache group CANNOT span multiple NUMA nodes (From AI)

```
Based on both the empirical check on your system and the architectural understanding:

  Why it's impossible:

  1. Physical Architecture:
    - L3 cache is physically located inside a CPU die/chiplet/CCD
    - NUMA nodes represent separate physical CPU sockets connected via inter-socket links (like AMD Infinity Fabric or Intel UPI)
    - You cannot physically share SRAM cache across different sockets - they're separate physical chips
  2. Your System Results:
    - All 8 L3 cache groups are confined to their respective NUMA nodes
    - NUMA node 0 has 4 L3 groups, NUMA node 1 has 4 L3 groups
    - No overlap whatsoever
  3. Architectural Hierarchy:
  System
  └── NUMA Node (Physical Socket)
      └── L3 Cache Group (CCD/Chiplet)
          └── Cores sharing that L3
              └── SMT siblings per core
  4. What cpus_share_cache() checks (kernel/sched/core.c:3884):
    - It compares sd_llc_id (Scheduling Domain Last-Level Cache ID)
    - This is a per-CPU value that identifies which L3 cache the CPU belongs to
    - CPUs in different sockets will always have different sd_llc_id values

  The Relationship:

  - NUMA node ⊃ L3 cache groups (superset relationship)
  - A NUMA node contains one or more L3 cache groups
  - An L3 cache group is fully contained within one NUMA node
  - They never overlap across NUMA boundaries

  On your AMD EPYC 9004 system:
  - 2 sockets = 2 NUMA nodes
  - Each socket has 4 CCDs (Core Complex Dies)
  - Each CCD has its own 16MB L3 cache
  - = 8 total L3 cache groups, perfectly partitioned by NUMA node
```

## Optimizing Linux for AMD EPYC™ 9004 Series Processors with SUSE Linux Enterprise 15 SP4

[Optimizing Linux for AMD EPYC™ 9004 Series Processors with SUSE Linux Enterprise 15 SP4](https://documentation.suse.com/sbp/tuning-performance/html/SBP-AMD-EPYC-4-SLES15SP4/index.html)


